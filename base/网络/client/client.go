package main

import (
	"bufio"
	"fmt"
	"net" // ç½‘ç»œé€šä¿¡åŒ…
	"os"
)

/*
	Net åŒ…:
		å®¢æˆ·ç«¯é€šè¿‡ Dial å‡½æ•°æ¥å»ºç«‹è¿æ¥

		æœåŠ¡ç«¯é€šè¿‡ Listen å‡½æ•°æ¥ç›‘å¬ç«¯å£
*/

func main() {
	// 1. å‡†å¤‡
	fmt.Println("ğŸ˜„ å®¢æˆ·ç«¯å¯åŠ¨...")


	// 2. è¿æ¥æœåŠ¡å™¨
	connect, err := net.Dial("tcp", "192.168.0.118:3030") // ğŸŒŸ è°ƒç”¨ Dial => å‚æ•°ä¸º tcp åè®® | ip + ç«¯å£
	if err != nil {
		fmt.Println("âŒ è¿æ¥å¤±è´¥...", err)
		return
	}
	fmt.Println("âœ… è¿æ¥æˆåŠŸ...", connect)


	// 3. ğŸ”¥ è·å–ç»ˆç«¯çš„è¾“å…¥å¹¶ä¿å­˜åœ¨ã€ç¼“å†²åŒºã€‘ä¸­ 
	reader := bufio.NewReader(os.Stdin) // ğŸŒŸ bufio.NewReader => ä»ç»ˆç«¯è·å–è¾“å…¥, å½¢æˆä¸€ä¸ª reader æµå¯¹è±¡
	for { // ğŸŒŸ å¾ªç¯è¯»å–ç»ˆç«¯è¾“å…¥
		// 4. è¯»å–ç¼“å†²åŒºå†…çš„å†…å®¹
		fmt.Println("âœï¸ è¯·è¾“å…¥å†…å®¹")

		str, err :=	reader.ReadString('\n') // ğŸŒŸ reader.ReadString => è¯»å–å­—ç¬¦ä¸², ç›´åˆ°é‡åˆ° \n ç»“æŸ
		if err != nil {
			fmt.Println("âŒ è¯»å–å¤±è´¥...", err)
			return
		}

		// âš ï¸ å¦‚æœç”¨æˆ·è¾“å…¥ç‰¹å®šçš„é€€å‡ºå‘½ä»¤ï¼Œæ¯”å¦‚"exit"ï¼Œåˆ™é€€å‡ºå¾ªç¯
		if str == "exit\n" {
			break
		}

		// 5. ğŸ”¥ å‘é€æ•°æ®ç»™æœåŠ¡å™¨, å‚æ•°éœ€è¦ä¼ å…¥ã€å­—èŠ‚åˆ‡ç‰‡ã€‘, å› ä¸º str æ˜¯å­—ç¬¦ä¸², æ‰€ä»¥éœ€è¦è½¬æ¢
		dataNum, err := connect.Write([]byte(str)) // ğŸŒŸ connect.Write => å‘é€æ•°æ®ç»™æœåŠ¡å™¨ , è¿”å› å‘é€çš„å­—èŠ‚æ•° ï½œ é”™è¯¯
		if err != nil {
			fmt.Println("âŒ å‘é€å¤±è´¥...", err)
			return
		}
		fmt.Printf("âœ… æ•°æ®å‘é€æˆåŠŸ, ä¸€å…±å‘é€äº† %v å­—èŠ‚çš„æ•°æ®", dataNum) // data è¡¨ç¤ºå‘é€çš„å­—èŠ‚æ•° => å¤šå°‘ KB
		fmt.Println("âœï¸ è¯·ç»§ç»­è¾“å…¥å†…å®¹")
	}
}