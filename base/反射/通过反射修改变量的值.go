package main

import (
	"fmt"
	"reflect"
)


// é€šè¿‡åå°„ä¿®æ”¹åŸºæœ¬æ•°æ®ç±»å‹çš„åå°„
func changeBaseNumDataReflect(x interface{}) {
	reValue := reflect.ValueOf(x)
	reValue.Elem().SetInt(200) // ğŸ‘ˆ Elem() è·å–æŒ‡é’ˆçš„å€¼!! æŠŠå¼•ç”¨çš„å€¼æ”¹ä¸º 200
}

// é€šè¿‡åå°„ä¿®æ”¹ã€ç»“æ„ä½“ã€‘çš„å€¼ Field() æ–¹æ³•è·Ÿ NumMethod() æ–¹æ³•
func changeStructReflect(x interface{}) {
	reValue := reflect.ValueOf(x) // x ä¸ºä¼ å…¥çš„ç»“æ„ä½“

	// ğŸ‘‡ è°ƒç”¨åå°„ç»“æ„ä½“å†…çš„æ–¹æ³• â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
	fmt.Println("ğŸ‘‡ è°ƒç”¨åå°„ç»“æ„ä½“å†…çš„æ–¹æ³• â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”")
	field := reValue.Elem().NumField()  // ğŸ‘ˆ Elem() å¯ä»¥è·å–å¼•ç”¨, ğŸŒŸ NumField() å¯ä»¥è·å–ç»“æ„ä½“æœ‰å¤šå°‘ä¸ªå­—æ®µæ•°é‡
	for i := 0; i < field; i++ {
		fmt.Printf("ç¬¬ %d ä¸ªå­—æ®µçš„å€¼æ˜¯: %v\n", i, reValue.Elem().Field(i))
	}

	methodNum := reValue.NumMethod() //ğŸ‘ˆ è·å–ç»“æ„ä½“çš„æ–¹æ³•æ•°é‡
	for i := 0; i < methodNum; i++ {
		fmt.Printf("ç¬¬ %d ä¸ªæ–¹æ³•çš„åç§°æ˜¯: %v\n", i, reValue.Method(i).Type())
	}

	reValue.Method(1).Call(nil) // è°ƒç”¨ç»“æ„ä½“å†…çš„æ–¹æ³• => ç¬¬ä¸€ä¸ªæ–¹æ³• => è¦è°ƒç”¨æ–¹æ³•çš„è¯, æ–¹æ³•çš„é¦–å­—æ¯å¿…é¡»å¤§å†™!! ğŸ”¥ åŒæ—¶æ–¹æ³•çš„é¡ºåºæŒ‰ç…§ ASCII ç çš„é¡ºåºè¿›è¡Œæ’åˆ—(a, b, c, d, ...)

	var params []reflect.Value	
	params = append(params, reflect.ValueOf(10)) // å› ä¸ºæ˜¯ []reflect.Value ç±»å‹, æ‰€ä»¥éœ€è¦ reflect.Valueof(10) æ¥ä¼ å‚
	params = append(params, reflect.ValueOf(20))
	result := reValue.Method(0).Call(params) // ğŸ‘ˆ ç”±äº Call æ–¹æ³•è¦æ±‚ä¼ å…¥ä¸€ä¸ª value åˆ‡ç‰‡, å› æ­¤éœ€è¦é€šè¿‡ä¸Šé¢çš„æ­¥éª¤å®šä¹‰åˆ‡ç‰‡å¹¶ä¼ å…¥æ•°æ®, è¿”å›å€¼ result ä¹Ÿæ˜¯ä¸€ä¸ªåˆ‡ç‰‡
	fmt.Printf("è°ƒç”¨æ–¹æ³•åè·å¾—çš„è¿”å›å€¼(åˆ‡ç‰‡)ä¸º: %v", result[0].Int()) // ğŸ”¥ reflect çš„è¿”å›å€¼, éœ€è¦è°ƒç”¨ Int() !!




	// ğŸ‘‡ ä¿®æ”¹åå°„ç»“æ„ä½“å†…çš„å±æ€§ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
	fmt.Println("ğŸ‘‡ ä¿®æ”¹åå°„ç»“æ„ä½“å†…çš„å±æ€§ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”")
	// SetInt(22)  | SetString("Jimmy") | ...
	z := reValue.Elem().NumField() // 2 ä¸ªå±æ€§
	fmt.Printf("è¯¥ç»“æ„ä½“å†…å…±æœ‰ %v ä¸ªå±æ€§ \n", z)
	reValue.Elem().Field(1).SetInt(22) // ä¿®æ”¹ç»“æ„ä½“å†…çš„å¹´é¾„, ğŸ‘‰ é¡ºåºæ˜¯æŒ‰ç…§ç»“æ„ä½“å®šä¹‰çš„é¡ºåº !!
	reValue.Elem().Field(0).SetString("é¥­å›¢")
}




// ç»“æ„ä½“
type Cat struct {
	Name string
	Age int
}

// ç»™ç»“æ„ä½“ç»‘å®šæ–¹æ³•
func (cat Cat) GetSum(n1, n2 int) int { // è¿”å›å€¼æ˜¯ int
	fmt.Println("è°ƒç”¨äº† GetSum æ–¹æ³•")
	return n1 + n2
}

func (cat Cat) Say() {
	fmt.Println("çŒ«å–µå«")
	fmt.Println("çŒ«çš„åå­—æ˜¯: ", cat.Name, "å¹´é¾„æ˜¯: \n", cat.Age)
}


func (cat Cat) Set(name string, age int) { // è®¾ç½®ç»“æ„ä½“å®ä¾‹åç§°çš„æ–¹æ³•
	cat.Name = name
	cat.Age = age
}




func main() {
	var num int = 100
	changeBaseNumDataReflect(&num) // ğŸ”¥ä¼ å…¥æŒ‡é’ˆ, ä¿®æ”¹çš„æ˜¯å¼•ç”¨åœ°å€çš„å€¼
	fmt.Printf("åå°„ä¿®æ”¹åçš„å€¼: %v \n", num)


	dudu := Cat {
		Name: "dudu",
		Age: 18,
	}
	changeStructReflect(&dudu)
	fmt.Printf("åç§°ä¿®æ”¹åçš„å€¼: %v \n", dudu.Name)
	fmt.Printf("å¹´é¾„ä¿®æ”¹åçš„å€¼: %v \n", dudu.Age)
}